
MF 22
SELECT CIA.NOMBRE FROM MF.LLAMADA LLAM INNER JOIN MF.TELEFONO TEL ON LLAM.TF_ORIGEN=TEL.NUMERO
INNER JOIN MF.COMPAÑIA CIA ON TEL.COMPAÑIA=CIA.CIF
WHERE TO_CHAR(LLAM.FECHA_HORA, 'DD/MM/YYYY')='16/10/2006'
GROUP BY CIA.NOMBRE
HAVING COUNT(*)>= ALL(SELECT COUNT(*) FROM MF.LLAMADA LLAM INNER JOIN MF.TELEFONO TEL ON LLAM.TF_ORIGEN=TEL.NUMERO
WHERE TO_CHAR(LLAM.FECHA_HORA, 'DD/MM/YYYY')='16/10/2006' GROUP BY CIA.NOMBRE);

MF 23
SELECT TEL.NUMERO, CLTE.NOMBRE 
FROM MF.CLIENTE CLTE INNER JOIN MF.TELEFONO TEL ON CLTE.DNI=TEL.CLIENTE
WHERE NOT EXISTS(SELECT * FROM MF.LLAMADA LLAM)
WHERE LLAM.TF_ORIGEN='654345345' AND TO_CHAR(LLAM.FECHA_HORA, 'MM/YY')='10/06'
AND NOT EXISTS(SELECT * FROM MF.LLAMADA LLAM2 
WHERE TEL.NUMERO=LLAM2.TF_ORIGEN AND LLAM2.TF_DESTINO=LLAM.TF_DESTINO AND LLAM2.TF_ORIGEN<>'654345345'));

MF 24
SELECT CLTE.NOMBRE AS CLIENTE, CIA.NOMBRE AS COMPAÑIA, SUM(LLAM.DURACION/60 * TAR.COSTE) AS COSTETOTAL
FROM MF.CLIENTE CLTE INNER JOIN MF.TELEFONO TEL ON TEL.CLIENTE=CLTE.DNI
INNER JOIN MF.TARIFA TAR ON TAR.TARIFA=TEL.TARIFA AND TAR.COMPAÑIA=TEL.COMPAÑIA
INNER JOIN MF.COMPAÑIA CIA ON CIA.CIF=TAR.COMPAÑIA
INNER JOIN MF.LLAMADA LLAM ON LLAM.TF_ORIGEN=TEL.NUMERO
GROUP BY CLTE.NOMBRE, CIA.NOMBRE
ORDER BY CLTE.NOMBRE DESC, CIA.NOMBRE ASC;

MF 25
SELECT CLTE.NOMBRE AS CLIENTE, SUM(LLAM.DURACION) AS DURACION
FROM MF.LLAMADA LLAM INNER JOIN MF.TELEFONO TEL ON LLAM.TF_ORIGEN=TEL.NUMERO
INNER JOIN MF.CLIENTE CLTE ON TEL.CLIENTE=CLTE.DNI
WHERE LLAM.TF_DESTINO IN(SELECT TEL.NUMERO
FROM MF.TELEFONO TEL INNER JOIN MF.CLIENTE CLTE ON TEL.CLIENTE=CLTE.DNI WHERE CLTE.PROVINCIA='JAEN')
AND LLAM.TF_ORIGEN IN(SELECT TEL.NUMERO
FROM MF.TELEFONO TEL INNER JOIN MF.CLIENTE CLTE ON TEL.CLIENTE=CLTE.DNI WHERE CLTE.PROVINCIA='LA CORUÑA')
GROUP BY CLTE.NOMBRE;

MF 26
SELECT CLTE.NOMBRE, COUNT (*)
FROM MF.LLAMADA LLAM INNER JOIN MF.TELEFONO TEL ON LLAM.TF_ORIGEN=TEL.NUMERO INNER JOIN
MF.CLIENTE CLTE ON CLTE.DNI=TEL.CLIENTE
GROUP BY CLTE.NOMBRE
HAVING COUNT(*) > 5;

MF 27
SELECT CLTE.NOMBRE AS CLIENTE, AVG(TAR.COSTE) AS MEDIA
FROM MF.CLIENTE CLTE INNER JOIN MF.TELEFONO TEL ON TEL.CLIENTE=CLTE.DNI
INNER JOIN MF.TARIFA TAR USING (TARIFA, COMPAÑIA)
GROUP BY CLTE.NOMBRE
HAVING AVG(TAR.COSTE)>=ALL (SELECT AVG(COSTE) FROM MF.TARIFA);

MF 28
SELECT CLTE.NOMBRE AS NOMBRE
FROM MF.LLAMADA LLAM INNER JOIN MF.TELEFONO TEL ON LLAM.TF_ORIGEN=TEL.NUMERO
INNER JOIN MF.TARIFA TAR USING(TARIFA, COMPAÑIA)
INNER JOIN MF.CLIENTE CLTE ON TEL.CLIENTE=CLTE.DNI
WHERE LLAM.TF_DESTINO IN(SELECT TEL.NUMERO FROM MF.TELEFONO TEL INNER JOIN MF.COMPAÑIA CIA ON TEL.COMPAÑIA=CIA.CIF
WHERE CIA.NOMBRE='KIETOSTAR')
GROUP BY CLTE.NOMBRE
HAVING SUM(LLAM.DURACION/60 * TAR.COSTE) <100;



